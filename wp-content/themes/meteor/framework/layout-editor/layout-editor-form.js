(function(e){function r(e){this.container=e,this.content=e.find(".content"),this.title=e.find(".head .title"),this.desc=e.find(".head .desc")}function i(){var e=[WP_TAXONOMY_DATA,WP_CUSTOM_DATA];for(var t,n,r,i,s,i,o=0;o<e.length;o++){t=e[o];for(n in t){r=[{title:" ",value:null}],i=t[n];for(s in i)r.push({title:i[s],value:s});t[n]=JSON.stringify(r)}}}function s(e,n,r){return n.type=e,n.values=JSON.parse(WP_TAXONOMY_DATA[n.taxonomy]),e=="checkbox"&&n.values.shift(),t[e].render(n,r)}function o(e,n,r){return n.type=e,n.values=WP_CUSTOM_DATA[n.context]?JSON.parse(WP_CUSTOM_DATA[n.context]):[],e=="checkbox"&&n.values.shift(),t[e].render(n,r)}window.ComponentForm=r;var t,n;e(document).ready(function(){i(),t={icon:Hogan.compile('<div class="option icon-option ui-icon-chooser">\n{{#title}}  <label class="title">{{title}}</label>\n{{/title}}\n  <p style="margin: 0 !important;">\n    <span class="preview-icon{{#value}} visible{{/value}}"><i{{#value}} class="{{{value}}}"{{/value}}></i></span>\n    <input type="hidden" name="{{{id}}}" value="{{{value}}}" tabindex="1" />\n  </p>\n{{#description}}  <div class="desc">{{{description}}}</div>\n{{/description}}\n</div><!-- .text-option -->'),text:Hogan.compile('<div class="option text-option">\n{{#title}}  <label class="title">{{title}}</label>\n{{/title}}\n  <input type="text" name="{{{id}}}" value="{{value}}" tabindex="1" autocomplete="off" />\n{{#description}}  <div class="desc">{{{description}}}</div>\n{{/description}}\n</div><!-- .text-option -->'),textarea:Hogan.compile('<div class="option textarea-option">\n  <label class="title">{{title}}</label>\n  <textarea {{#code}}class="code-entry" {{/code}}name="{{{id}}}" rows="{{{rows}}}" tabindex="1">{{value}}</textarea>\n{{#description}}  <div class="desc">{{{description}}}</div>\n{{/description}}\n</div><!-- .textarea-option -->'),select:Hogan.compile('<div class="option select-option">\n  <label class="title">{{title}}</label>\n  <select name="{{{id}}}" tabindex="1">\n{{#values}}\n{{> option}}\n{{/values}}\n  </select>\n{{#description}}  <div class="desc">{{{description}}}</div>\n{{/description}}\n</div><!-- .select-option -->'),radio:Hogan.compile('<div class="option radio-option multiple">\n  <label class="title">{{title}}</label>\n{{#values}}\n{{> radio}}\n{{/values}}\n{{#description}}  <div class="desc">{{{description}}}</div>\n{{/description}}\n</div><!-- .radio-option -->'),checkbox:Hogan.compile('<div class="option checkbox-option multiple">\n  <label class="title">{{title}}</label>\n{{#values}}\n{{> checkbox}}\n{{/values}}\n{{#description}}  <div class="desc">{{{description}}}</div>\n{{/description}}\n</div><!-- checkbox-option -->')},n={option:Hogan.compile('    <option value="{{{value}}}"{{#selected}} selected="selected"{{/selected}}>{{title}}</option>\n'),radio:Hogan.compile('  <p><label><input type="radio" name="{{{id}}}" value="{{{value}}}"{{#checked}} checked="checked"{{/checked}} tabindex="1" /> {{title}}</label></p>\n'),checkbox:Hogan.compile('  <p><label><input type="checkbox" name="{{{id}}}[{{{value}}}]"{{#checked}} checked="checked"{{/checked}} tabindex="1" /> {{title}}</label></p>\n')}}),r.prototype.render=function(r){var i,u,a=JSON.parse(LAYOUT_COMPONENTS[r.shortcode]).options;for(var f,l=a.length,c=0;c<l;c++){f=a[c];for(var h,p=r.options.length,d=0;d<p;d++)h=r.options[d],h.id===f.id&&(a[c]=h)}r.options=a;for(i=[],c=0;c<r.options.length;c++){f=r.options[c],f.type=="icon"&&f.value==""&&(f.value=null);if(f.type!="select"&&f.type!="checkbox"||!f.taxonomy&&!f.context)if(f.type in t)i.push(t[f.type].render(f,n));else switch(f.type){case"taxonomy_select":i.push(s("select",f,n));break;case"taxonomy_checkbox":i.push(s("checkbox",f,n));break;case"custom_select":i.push(o("select",f,n));break;case"custom_checkbox":i.push(o("checkbox",f,n))}else{var v,m=[];f.taxonomy?v=JSON.parse(WP_TAXONOMY_DATA[f.taxonomy]):f.context&&(v=WP_CUSTOM_DATA[f.context]?JSON.parse(WP_CUSTOM_DATA[f.context]):[]);for(d=0;d<f.values.length;d++)u=f.values[d],(u.selected||u.checked)&&m.push(u.value);for(d=0;d<v.length;d++){u=v[d];if(m.indexOf(u.value)>=0){if(f.type=="select"){u.selected=!0;break}f.type=="checkbox"&&(u.checked=!0)}}f.values=v,f.type=="checkbox"&&f.values[0]&&f.values[0].title===" "&&f.values.shift(),i.push(t[f.type].render(f,n))}}this.title.text(r.title),this.desc.text(r.generator),i=e(i.join("\n\n")),r.galleryInterface&&i.find("textarea").galleryInterface(r.galleryInterface),this.content.html(i),this.content.find(".ui-icon-chooser").iconChooser()},r.prototype.reset=function(){this.title.text(""),this.desc.text(""),this.content.html("")},r.prototype.serialize=function(t){var n=this.title.text();n!=t.title&&(t.title=n);var r=t.options;for(var i,s,o=r.length,u,a=0;a<o;a++){i=r[a];switch(i.type){case"icon":i.value=this.content.find("input:hidden[name="+i.id+"]").val();break;case"text":i.value=this.content.find("input:text[name="+i.id+"]").val();break;case"textarea":i.value=this.content.find("textarea[name="+i.id+"]").val();break;case"radio":s=this.content.find("input:radio[name="+i.id+"]:checked").val();for(u=0;u<i.values.length;u++)i.values[u].value==s?i.values[u].checked=!0:delete i.values[u].checked;break;case"select":this.content.find("select[name="+i.id+"] option").each(function(t,n){var r=e(n);r.is(":selected")?i.values[t].selected=!0:delete i.values[t].selected});break;case"checkbox":for(u=0;u<i.values.length;u++){var f=this.content.find("input:checkbox[name="+i.id+"\\["+decodeURI(i.values[u].value).replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/&/,"\\&")+"\\]]");f.is(":checked")?i.values[u].checked=!0:delete i.values[u].checked}}}}})(jQuery);